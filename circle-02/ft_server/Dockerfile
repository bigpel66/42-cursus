# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Dockerfile                                         :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: jseo <jseo@student.42seoul.kr>             +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2021/06/02 20:05:51 by jseo              #+#    #+#              #
#    Updated: 2021/06/04 13:49:24 by jseo             ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

###############################################################################
#							Image Info
###############################################################################
FROM		debian:buster
LABEL		author	bigpel66

###############################################################################
#							ARG for Script (Do not use default value)
###############################################################################
ARG			sv_hst="localhost"
ARG			db_doc="wordpress"
ARG			db_usr="root"
ARG			db_pas="1234"
ARG			db_sec="uW;l-=]Py3G8q1.m{ExtMe6rZDH4BbqX"

###############################################################################
#							Make ARG to ENV (ENV will be unset)
###############################################################################
ENV			sv_hst		${sv_hst}
ENV			db_doc		${db_doc}
ENV			db_usr		${db_usr}
ENV			db_pas		${db_pas}
ENV			db_sec		${db_sec}
ENV			autoindex	true

###############################################################################
#							Install Dependencies
###############################################################################
RUN			apt-get			update	-y										\
				&& apt-get	install	-y	wget								\
										vim									\
										nginx								\ 
										openssl								\
										mariadb-server						\
										php-xml								\
										php-mysql							\
										php-mbstring						\
										php7.3-fpm

###############################################################################
#							Volume for Database
###############################################################################
VOLUME		/var/lib/mysql

###############################################################################
#							Copy Config Files
###############################################################################
COPY		srcs/*	/tmp/

###############################################################################
#							Specify Ports for Running Server
###############################################################################
EXPOSE		80		443

###############################################################################
#							Commands after Building Image
###############################################################################
ENTRYPOINT	["/bin/bash",	"/tmp/run.sh"]
